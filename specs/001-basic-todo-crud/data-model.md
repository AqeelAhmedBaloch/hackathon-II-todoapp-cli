# Data Model: Basic Todo CRUD Operations

**Feature**: 001-basic-todo-crud
**Date**: 2025-12-29
**Phase**: Phase 1 - Design & Contracts

## Purpose

Define the data structures and entities required for the Phase-1 Todo Console Application. This document specifies entity attributes, validation rules, relationships, and state transitions.

---

## Entities

### Task

**Description**: Represents a single todo item that a user wants to track.

**Attributes**:

| Attribute | Type | Required | Constraints | Default | Description |
|-----------|------|----------|-------------|---------|-------------|
| id | int | Yes | Positive integer, unique, auto-generated | (generated) | Unique identifier for the task |
| title | str | Yes | 1-200 characters, no whitespace-only | (none) | Short description of the task |
| description | str | No | Max 1000 characters | "" (empty string) | Detailed information about the task |
| completed | bool | Yes | Boolean (True/False) | False | Whether the task is completed |

**Validation Rules**:

1. **Title Validation** (FR-002, FR-014):
   - MUST NOT be None or empty string
   - MUST NOT contain only whitespace characters
   - MUST be between 1 and 200 characters (inclusive)
   - Special characters and Unicode allowed
   - Leading/trailing whitespace should be stripped during validation

2. **Description Validation** (FR-002, FR-015):
   - MAY be None, empty string, or omitted (optional field)
   - If provided, MUST NOT exceed 1000 characters
   - No other restrictions (all characters allowed)

3. **ID Validation**:
   - MUST be positive integer (>= 1)
   - MUST be unique within the task list
   - Auto-generated by TaskService (not user-provided)
   - Sequential (1, 2, 3, ...)

4. **Completed Validation**:
   - MUST be boolean (True or False)
   - No other values allowed (not None, not 0/1, not strings)

**Example Valid Tasks**:

```python
# Minimal task
Task(id=1, title="Buy groceries", description="", completed=False)

# Task with description
Task(id=2, title="Call dentist", description="Schedule annual checkup", completed=False)

# Completed task
Task(id=3, title="Finish report", description="Q4 financial summary", completed=True)

# Task with special characters
Task(id=4, title="Review PR #123", description="Feature: add user auth ðŸ”", completed=False)

# Long title and description
Task(
    id=5,
    title="A" * 200,  # Exactly 200 characters
    description="B" * 1000,  # Exactly 1000 characters
    completed=False
)
```

**Example Invalid Tasks**:

```python
# Invalid: empty title
Task(id=1, title="", description="", completed=False)  # ValidationError

# Invalid: whitespace-only title
Task(id=2, title="   ", description="", completed=False)  # ValidationError

# Invalid: title too long
Task(id=3, title="A" * 201, description="", completed=False)  # ValidationError

# Invalid: description too long
Task(id=4, title="Valid", description="B" * 1001, completed=False)  # ValidationError

# Invalid: non-boolean completed
Task(id=5, title="Valid", description="", completed="yes")  # Type error

# Invalid: negative ID
Task(id=-1, title="Valid", description="", completed=False)  # ValidationError
```

---

## State Transitions

**Task Lifecycle**:

```
[Non-existent]
    |
    | add_task(title, description)
    | -> ID assigned, completed=False
    v
[Incomplete Task]
    |
    | toggle_complete(id)
    | -> completed=True
    v
[Complete Task]
    |
    | toggle_complete(id)
    | -> completed=False
    v
[Incomplete Task]
    |
    | update_task(id, new_title, new_description)
    | -> title/description modified
    | (remains in same completion state)
    |
[Any State]
    |
    | delete_task(id)
    v
[Non-existent]
```

**State Transition Rules**:

1. **Creation** (add_task):
   - Task starts in Incomplete state (completed=False)
   - ID auto-assigned by incrementing counter
   - Title and description set from user input (validated)

2. **Completion Toggle** (toggle_complete):
   - Incomplete â†’ Complete: Set completed=True
   - Complete â†’ Incomplete: Set completed=False
   - Can toggle multiple times
   - Title and description unchanged

3. **Update** (update_task):
   - Title and/or description modified
   - Completed state unchanged
   - ID unchanged
   - Validated same as creation

4. **Deletion** (delete_task):
   - Task removed from list
   - ID not reused
   - Irreversible operation

5. **View** (get_all_tasks, get_task_by_id):
   - Read-only operation
   - No state change

---

## Storage Structure

**In-Memory Representation**:

```python
# TaskService class attributes
class TaskService:
    tasks: List[Task] = []       # List of all Task objects
    next_id: int = 1             # Counter for next task ID

# Example storage state
tasks = [
    Task(id=1, title="Buy milk", description="", completed=False),
    Task(id=2, title="Read book", description="Chapter 5", completed=True),
    Task(id=3, title="Exercise", description="30 min cardio", completed=False)
]
next_id = 4  # Next task will get ID=4
```

**Storage Characteristics**:
- Linear data structure (Python list)
- Tasks stored in creation order
- No indexing by ID (O(n) lookup)
- No persistence (data lost on exit)
- No maximum size enforced (limited by memory)

**Performance Characteristics**:

| Operation | Time Complexity | Space Complexity |
|-----------|----------------|------------------|
| Add task | O(1) | O(1) |
| View all tasks | O(n) | O(1) |
| Find by ID | O(n) | O(1) |
| Update task | O(n) | O(1) |
| Delete task | O(n) | O(1) |
| Toggle complete | O(n) | O(1) |

*n = number of tasks. Expected n < 1000, making O(n) operations acceptable (<1ms).*

---

## Relationships

**No relationships in Phase-1**. Task is the only entity.

Future phases may introduce:
- User â†’ Tasks (one-to-many)
- Category â†’ Tasks (one-to-many)
- Task â†’ Subtasks (self-referential, hierarchical)

These are explicitly out of scope for Phase-1.

---

## Data Integrity Rules

1. **ID Uniqueness**:
   - Each task MUST have a unique ID
   - IDs MUST NOT be reused after deletion
   - Counter MUST always increment

2. **Title Required**:
   - Every task MUST have a non-empty title
   - No task with missing or whitespace-only title can exist

3. **Completion Status**:
   - Every task MUST have a boolean completed status
   - No null or missing completed values allowed

4. **Description Optional**:
   - Description MAY be empty string or omitted
   - NULL/None treated as empty string

5. **No Orphaned Data**:
   - Tasks MUST be in the tasks list
   - No tasks can exist outside the TaskService

---

## Validation Error Messages

User-friendly error messages for validation failures:

| Validation Failure | Error Message |
|-------------------|---------------|
| Empty title | "Title is required" |
| Whitespace-only title | "Title cannot be empty or whitespace only" |
| Title too long (>200) | "Title must be 200 characters or less" |
| Description too long (>1000) | "Description must be 1000 characters or less" |
| Task not found | "Task not found" |
| Invalid ID format | "Invalid task ID" |
| Non-numeric ID | "Task ID must be a number" |

---

## Testing Considerations

**Unit Test Cases for Task Entity**:

1. Valid task creation with all fields
2. Valid task creation with minimal fields (no description)
3. Invalid: empty title
4. Invalid: whitespace-only title
5. Invalid: title > 200 characters
6. Invalid: description > 1000 characters
7. Valid: special characters in title/description
8. Valid: Unicode/emoji in title/description
9. Valid: exactly 200-char title
10. Valid: exactly 1000-char description
11. State transitions (incomplete â†” complete)
12. Task equality/comparison

**Service Layer Test Cases**:

1. Add task and verify ID assignment
2. Add multiple tasks and verify ID increment
3. Retrieve task by ID (found/not found)
4. View all tasks (empty list, populated list)
5. Update task (title only, description only, both)
6. Delete task (exists, doesn't exist)
7. Toggle complete (incompleteâ†’complete, completeâ†’incomplete)
8. ID uniqueness across operations

---

## Summary

**Single Entity**: Task (id, title, description, completed)

**Storage**: In-memory Python list + integer counter

**Key Constraints**:
- Title: required, 1-200 chars, no whitespace-only
- Description: optional, max 1000 chars
- ID: unique, auto-generated, sequential integers
- Completed: boolean, defaults to False

**Operations**: Create, Read, Update, Delete, Toggle Complete

**No persistence**: Data lost on application exit (Phase-1 constraint)
